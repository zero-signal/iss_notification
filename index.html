<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>ISS Notifications by zero-signal</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>
      <div id="header">
        <nav>
          <li class="fork"><a href="https://github.com/zero-signal/iss_notification">View On GitHub</a></li>
          <li class="downloads"><a href="https://github.com/zero-signal/iss_notification/zipball/master">ZIP</a></li>
          <li class="downloads"><a href="https://github.com/zero-signal/iss_notification/tarball/master">TAR</a></li>
          <li class="title">DOWNLOADS</li>
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section>
        <div id="title">
          <h1>ISS Notifications</h1>
          <p>International Space Station overhead pass notifications <br/>(using Python and Arduino to control cheap RGB LED strips)</p>
          <hr>
          <span class="credits right">Project maintained by <a href="https://github.com/zero-signal">zero-signal</a></span>
        </div>

        <h3>
<a name="introduction" class="anchor" href="#introduction"><span class="octicon octicon-link"></span></a>Introduction</h3>

<p>
I recently bought some cheap RGB LED strip lights, which included 16.4ft of weatherproof RGB LEDs, an infra-red receiver unit to control the strip, an AC power adapter and a 44 button remote control all for about $20. LEDs are not addressable but they are easy and cheap to find. As you can see from the image below these were 'Supernight' branded and are easy to find online.
</p>
<img src="images/leds.jpg" width="300" height="300" align="center" />
<p/>
<p>
At first I thought they were cool just being used to light up my office, but soon thought I'd have a go at controlling them using an Arduino. I did not want to damage the remote or the receiver so looked at using an IR LED hooked up to my ageing Arduino Duemilanove to control the light strip.
</p>
<p>Using the excellent <a href="https://github.com/shirriff/Arduino-IRremote">IRremote</a> library from Ken Shirriff I was easily able to record the signals from the original remote control unit and play them back using an Arduino. So far so good but I needed a project.
</p>
<p>Enter the International Space Station (ISS).
</p>
<p>
Using the great <a href="http://open-notify.org">OpenNotify</a> API by Nathan Bergey I created some scripts and Arduino firmware to control the strip lights according to the current position of the ISS! I have seen similar projects such as this before (in fact Nathan has one up on Kickstarter which OpenNotify was created to support) but I thought I'd use what I already had lying around!
</p>

<h3>
<a name="python-script" class="anchor" href="#python-script"><span class="octicon octicon-link"></span></a>Python script</h3>

<p>The included <code>iss_notification.py</code> script uses the open source <a href="http://open-notify.org">OpenNotify</a> API to retrieve calculated overhead passes of the ISS for a given observation position defined by latitude/logitude and altiude.
</p>
<p>Retrieved passes get printed to the terminal window and optionally simple 'status' codes can be sent over a serial port (which is specified by the <code>-s</code> or <code>--serial</code> command line option. This is intended to be used in order to send some physical indication of upcoming ISS passes and how far away in time they are. In my case, I'm using receiving these commands with an Arduino and using it to replay the IR codes to control the LEDs.
</p>
<p>The script uses are series of simple states, which depending on how far the ISS is from the invokers location dictates how often pass data is retrieved. These states are defined in the dictionary object <code>iss_states</code> but can be described as follows:
</p>
<ul>
<li><strong>RECEDING</strong>: ISS &gt; 45 mins away, update every 120s</li>
<li><strong>APPROACHING</strong>: ISS &lt; 45 mins away, but &gt; 15 mins away, update every 60s</li>
<li><strong>CLOSING</strong>: ISS &lt; 15 mins away, but &gt; 5 mins away, update every 30s</li>
<li><strong>INCOMING</strong>: ISS &lt; 5 mins away, but &gt; 1 min away, update every 15s</li>
<li><strong>IMMINENT</strong>: ISS &lt; 1 min away, update every 5 seconds</li>
<li><strong>OVERHEAD</strong>: ISS overhead, no update until pass has completed.</li>
</ul>

<p>This scheme is used in order to minimise load on the open-notify API servers whilst attempting to increase the accuracy of the notifications as the ISS approaches the observers location.
</p>

<p>If using the <code>--serial</code> option, different codes are sent (currently just simple ASCII values) according to the 'state' transitions (see above). Currently, the script outputs the letters A thru F, with Z being denoted as a test command. 
</p>
<p>
Commands are delimited by a leading '$' and a trailing '!' 
</p>

<h4><a name="python-script-invocation" class="anchor" href="#python-script-invocation"><span class="octicon octicon-link"></span></a>Invocation</h4>

<p>The only required parameters for the script are a longitude and latitude pair, so the script can simply be invoked as follows to display pass data to the terminal window:
</p>

<pre><code>python ./iss_notitification.py --latitude 11.11 --longitude 22.22</code></pre>

<p>Note: This will NOT output anything to a serial port. To do so, add the <code>--serial</code> command line argument as follows:</p>

<pre><code>python ./iss_notitification.py --latitude 11.11 --longitude 22.22 --serial /dev/ttyUSB0</code></pre>

<p>Often, the screen utility is useful to start the process in a background (detached) state, like the following example. This is useful for running the script within a startup script:

<pre><code>screen -d -m -S "ISS_NOTIFY" python ./iss_notification.py --latitude 11.11 --longitude 22.22 --serial /dev/ttyUSB0</code></pre>

<p>More detailed usage information (including information on additional command line options not discussed here) can be found by invoking the scripts built in usage documentation as follows:

<pre><code>python ./iss_notification.py --help</code></pre>

<h4><a name="python-script-requirements" class="anchor" href="#python-script-requirements"><span class="octicon octicon-link"></span></a>Requirements</h4>

<p>This script was developed and tested on <strong>Python v2.7.5</strong> and is known not to work without modification on <strong>v3.x</strong></p>
<p>The script also requires the following libraries:</p>
<ul>
<li>python-requests</li>
<li>python-serial</li>
<li>python-enum34</li>
</ul>

<h4><a name="python-script-additional-requirements" class="anchor" href="#python-script-additional-requirements"><span class="octicon octicon-link"></span></a>Additional Requirements</h4>

<p>In order to ensure maximum script accuracy you should ensure that your computers time is accurate and that you have your timezone correctly configured. The easiest way to ensure clock accuracy is to install and configure the <strong>Network Time Protocol (NTP)</strong> utilities.
</p>


<h3>
<a name="arduino-hardware" class="anchor" href="#arduino-hardware"><span class="octicon octicon-link"></span></a>Arduino Hardware</h3>
<p>The Arduino hardware for this project is extremely simple. Basically it is an IR-LED (with current limiting resistor) attached to Pin 3 (PWM output) of the Arduino.</p>
<p>For the sake of completeness here are the components I used for the project:</p>
<ul>
<li>1 x Arduino Duemilanove (or Uno, most standard arduino boards should work)</li>
<li>1 x TSAL 6400 940nm IR-LED</li>
<li>1 x 47R 1/4w resistor</li>
<li>A couple of jumper wires</li>
<li>A box to put it all in (optional)</li>
</ul>
<p>Connecting up the hardware is shown in the diagram below:</p>
<img src="images/schematic.png" width="500" align="center" />
<p/>
<p>For more information on recording codes from the original IR remote and further detailed documentation on the Aruino IRremote library see <a href="http://www.righto.com/2009/08/multi-protocol-infrared-remote-library.html">this</a> page.
</p>

<h4><a name="additional-hardware" class="anchor" href="#additional-hardware"><span class="octicon octicon-link"></span></a>Additional Hardware</h4>
<p>In addition to the above hardware for the Arduino part of the project you will also need the following:</p>
<ul><li>1 x Supernight RGB LED strip (with remote and AC adapter included)</li>
</ul>

<h3>
<a name="arduino-firmware" class="anchor" href="#arduino-firmware"><span class="octicon octicon-link"></span></a>Arduino Firmware</h3>
<p>Like the hardware, the Arduino firmware for this project is very simple. Just load it up in the Arduino IDE, choose your board and serial port from the IDE menus and upload the sketch to the board.</p>

<p>Simply, the Arduino firmware listens for commands from the Python script, and once the command has been parsed correctly, uses the command to send the corresponding 'code' to the LED strip receiver in order to change the light colors.</p>

<p>Generally, once a new command is received, the firmware uses a couple of simple timers to 'blink' the strips between the old and new colors in order to grab the attention of anyone nearby.</p>

<p>The colors used are as follows:</p>
<ul>
<li><strong>RECEDING</strong>: Red (Code: $A!)</li>
<li><strong>APPROACHING</strong>: Orange (Code: $B!)</li>
<li><strong>CLOSING</strong>: Yellow (Code: $C!)</li>
<li><strong>INCOMING</strong>: Green (Code: $D!)</li>
<li><strong>IMMINENT</strong>: Green/Blue (flashing continuously, Code: $E!)</li>
<li><strong>OVERHEAD</strong>: Blue (Code: $F!)</li>
</ul>

<p>The firmware also accepts a test command ($Z!) which will cycle through the codes above. This gets called when the <code>iss_notification.py</code> script first starts in order to provide visual confirmation that everything is working as intended.</p>

<h4><a name="additional-libraries" class="anchor" href="#additional-libraries"><span class="octicon octicon-link"></span></a>Additional Libraries</h4>
<p>The Arduino firmware requires Ken Shirriff's IRremote library installed on your system in order to compile and upload the sketch</p>

<h3>
<a name="video" class="anchor" href="#video"><span class="octicon octicon-link"></span></a>Video</h3>

<iframe width="420" height="315" src="//www.youtube.com/embed/Plh9phU5w5k" frameborder="0" allowfullscreen></iframe>
<p>
Apologies for the low quality video, it looks much better in real life!
<p/>
<h3>
<a name="credits" class="anchor" href="#credits"><span class="octicon octicon-link"></span></a>Credits</h3>

<p>
The <a href="http://open-notify.org">OpenNotify</a> API is copyright Nathan Bergey (<a href="https://github.com/natronics" class="user-mention">@natronics</a>)
</p>

<p>
The Arduino library <a href="https://github.com/shirriff/Arduino-IRremote">IRremote</a> is copyright Ken Shirriff (<a href="https://github.com/shirriff" class="user-mention">@shirriff</a>)
</p>

<h3>
<a name="disclaimer" class="anchor" href="#disclaimer"><span class="octicon octicon-link"></span></a>Disclaimer</h3>

<p>
This software and its documentation is provided as-is. I take no responsibility for the accuracies of this script or any of the external services/APIs that it may use to generate its notifications. 
</p>
<p>Please be aware that notifications are only accurate to within a few seconds and are not intended to give scientifically precise indications of the ISS' current orbital position (and as such, should not be relied upon to do so).
</p>
<p>
This script and associated instructions are provided purely for casual observations of ISS passes.
</p>

<h3>
<a name="license" class="anchor" href="#license"><span class="octicon octicon-link"></span></a>License and Copyright</h3>
<p>Copyright (C) 2014 - Zerosignal</p>
<p>This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.</p>
<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License along with this program. If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.</p>
      </section>

    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>
